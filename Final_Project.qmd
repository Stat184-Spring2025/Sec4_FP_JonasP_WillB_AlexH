---
title: "Student Lifestyle Factors and their Effects"
author: "Jonas Priolo, Will Bolger, Alejandro Herraiz Sen"
editor: visual
date: "April 25, 2025"
date-modified: now
format: pdf
bibliography: references.bib
nocite: |
  @*
csl: MLA9.csl
execute:
  echo: false
  warning: false
---

```{r}
#| label: load_packages
# Load necessary packages ----
library(ggplot2)
library(dplyr)
library(knitr)
library(tinytex)
library(tidyverse)
library(tibble)
library(broom)
library(purrr)
# Google R style guide used
```

```{r}
#| label: load_data
#Primary Dataset
student_raw <-  read.csv(
  "https://raw.githubusercontent.com/Stat184-Spring2025/Sec4_FP_JonasP_WillB_AlexH/refs/heads/main/data_folder/student_lifestyle_dataset..csv",
  sep = ","
)
#Supplementary Dataset
mental_health_raw <- read.csv(
  "https://raw.githubusercontent.com/Stat184-Spring2025/Sec4_FP_JonasP_WillB_AlexH/refs/heads/main/data_folder/Processed.csv",
  sep = ","
)

```

```{r}
#| label: GPA to 4.0 scale for primary dataset
#Converts the provided 10 point GPA scale to a 4 point scale for the primary dataset
student_4 <- student_raw %>%
  mutate(Grades = Grades * (4/10)) 
```

# Introduction

## Research Topic: Student Lifestyle Factors and their Effects

This research focuses on Student lifestyle trends and their effects on things such as their grades and stress levels. With depression and anxiety rates being at all time highs and finals week just around the corner this subject is not only relevant to society but to everyone in our group/class. Our research revolves around gaining a better understanding on what effects student outcomes such as stress and GPA pertaining to a students daily study hours, extracurricular hours, sleep hours, social hours, and physical activity. Via researching our topic in depth, mapping our data in data sets, and by utilizing data visualizations we can explore the relations between our key attributes and student well being. Our goal is to increase our understanding of the effects of different lifestyle factors and how much they affect our lives as well as presenting our research in a way our reader could deepen their own knowledge for this topic.

## Research Questions

The first research question we will explore is how different lifestyle factors, such as hours spent studying, sleeping, socializing, exercising, or time spent doing extracurriculars affect both student stress levels and academic performance. We will create different visualizations to present our research findings and explain the relationships between each of our key attribute lifestyle factors and their effects. In addition to this we will also examine gender and its effects on the different items we are analyzing. We are also interested in examining a student's major and its impact on their mental health. For example, is a student who is studying an engineering related discipline more stressed or depressed then a student who is studying business? Another question we want to answer is weheter an individual who is on a scholorship has higher levels of stress compared to someone without one. For our research we will also need to be aware of potential biases we may have. All three of us are males and are pursuing STEM fields and we cant let our own experiences alter our conclusion. 

## Provenance Of Our Data

The data sets we are using came from the Website Kaggle, a data science website that offers open source resources and data sets with the goal to help others learn more about data. The author of our first and primary data set is Charlotte Bennett. The author describes there data as a “detailed view of student lifestyle patterns and their correlation with academic performance, represented by GPA.” The data contains detailed student survey data across a variety of student lifestyle factors, student demographics, and academic outcomes. This data was last updated 21 days ago and was sourced from a Google Form survey focusing on students across different educational institutions, primarily focusing on those in India and other South Asian countries. All in all there were 2000 voluntary participants for the survey used in the data set and the respondents were informed that the data would be used for educational purposes only. No personally identifiable information was collected for the data set. In this data set, a case is an individual student. The data set includes the attributes of Student ID, Study Hours per Day, Extracurricular Hours per Day, Sleep Hours Hours per Day, Social Hours per Day, Physical Activity Hours per Day, Stress Level, Gender, And Grades (CGPA). For this data set we will touch upon all of these attributes. For this data set we intend on converting the ten point GPA scale provided in the data set, which is the standard grading scale in India and South Asia, to the four point GPA scale we are more familiar with.

Our second and supplementary data set also originates from Figshare. The author of this data set is Mahbubul and he describes the data set as “a statistical research on the effects of mental health.” The data for this set was collected via survey form from students studying at the top 15 ranked universities in Bangladesh. The data set includes the attributes of a age, gender, University, major, academic year, GPA, scholarship status, answers to survey questions, student stress levels, student anxiety levels, and student depression levels. For this data set we are primarily interested in the students major, there scholarship status, and there stress level.

## CARE Principles

The data we are utilizing meets the CARE principles. The data can be used for the Collective benefit because it allows for us to identify what are the main factors that contribute to student well being. When properly analyzed as a society we can improve student resources and improve student mental health. This data meets the Authority to control because the data was collected via an optional survey. This means that participants had the autonomy to choose whether or not to share their experiences, ensuring respect for an individual's data and consent. The data aligns with Responsibility because it emphasizes the ethical use for this information such as prioritizing student welfare and protecting student privacy. Lastly this data is ethical with it promoting equity and positive change with its ability to inform policies to support student well-being.

## Main Data Set

1.  Data Tidying

For our main data set, it was already tidy, and didn't require any changes to it. Each row was considered a single case, with each case being a student. Each column represented a single variable, with no cell containing multiple data points. The variables in this case was student id, study hours per day, extracurricular activity per day, sleep hours per day, social hours per day, physical activity hours per day, reported stress level, their gender, and their GPA.

2.  Data Wrangling

For data wrangling, we did reshape the data to make it more understandable to US audiences. In the US, the primary GPA scale is a 4 point scale, while our data was in a 10 point scale. We converted it into a 4 point scale by multiplying it by 0.4.

```{r}
#| label: GPA to 4.0 scale for primary dataset
#Converts the provided 10 point GPA scale to a 4 point scale for the primary data set
student_4 <- student_raw %>%
  mutate(Grades = Grades * (4/10)) 
```

3.  Data Cleaning

There was no data cleaning required as there were no missing values, no incorrect values, and no duplicates among the data set. BY summing the duplicate function on our data set, we can see that there are no duplicates.

```{r}
#| label: Proof of no duplicates
sum(duplicated(student_4))
```

## Exploratory Data Analysis

Before creating any data visualizations, we created a frequency that alalyise a series of statistics to better understand the relation between student stress levels and a students grades. @tbl-student_stress_summary shows a summary table that includes *count*, *minimum*, *Q1*, *median*, *Q3*, *maximum*, *median absolute deviation*, *mean*, and *standard deviation* for every stress level and student GPA. We are interested in using this data to gain a better understanding of student stress and its impacts and we thought that a students GPA was a good metric to start with.

### Scatter Plot Matrices

We created two different scatter plot matrices to help us get a baseline overview of the data to help us better understand what we were analyzing. We took out three columns from the original data set, as they would not give valuable information in these visualizations. These three were the student id, gender, and GPA. We took out student id as it is a number assigned to each student and has no impact on any of the other variables. Next, we used gender and stress level to create 2 different scatter plot matrices as they were both categorical data, and would be unhelpful to directly graph against continuous data. After eliminating those three variables, we plotted the other variables of study hours per day, extracurricular hours per day, sleep hours per day, social hours per day, physical activity hours per day, and the students GPA on a 4.0 scale.

```{r}
#| label: scatter-plot-stress-matrix
#| fig-cap: "Scatter plot matrix with stress level"
#| fig-pos: H
#| fig-height: 6
#| fig-alt: "Scatter plot matrix with colors based on stress level"
#| lst-label: lst-scatter-plot-matrix-stress
#| lst-cap: "Code Chunk for Scatter Plot Matrix with Stress"
# Remove Student_ID column
students_scatter_matrix <- student_4 %>%
  subset(, select = -c(Student_ID))
# Define colors
my_cols <- c("Blue", "Red", "dark Green")

#Rename labels
students_scatter_matrix <- students_scatter_matrix %>%
  rename(
    Study = Study_Hours_Per_Day,
    Extracurricular = Extracurricular_Hours_Per_Day,
    Sleep = Sleep_Hours_Per_Day,
    Social = Social_Hours_Per_Day,
    Physical_Activity = Physical_Activity_Hours_Per_Day,
    GPA = Grades
  )

# Make Stress_Level a factor
students_scatter_matrix$Stress_Level <- as.factor(students_scatter_matrix$Stress_Level)

# Create a color map
color_map <- setNames(
  my_cols[
    1:length(
      levels(
  students_scatter_matrix$Stress_Level
  ))],
  levels(
    students_scatter_matrix$Stress_Level
    ))

# Plot Stress_Level as colors and without Gender 
plot(
  subset(
    students_scatter_matrix, 
    select = -c(Gender, Stress_Level)
    ),
  pch = ".",
  col = color_map[students_scatter_matrix$Stress_Level],
)
```

For this first scatter plot matrix, the different colored points represents the different stress levels reported by the students. The green points represent those with a reported high stress, red with a reported moderate stress level, and blue representing a reported low stress level.

```{r}
#| label: scatter-plot-gender-matrix
#| fig-cap: "Scatter plot matrix with Gender"
#| fig-pos: H
#| fig-height: 6
#| fig-alt: "Scatter plot matrix with colors based on Gender"
#| lst-label: lst-scatter-plot-matrix-gender
#| lst-cap: "Code Chunk for Scatter Plot Matrix with Gender"
# Remove Student_ID column
students_scatter_matrix <- student_4 %>%
  subset(, select = -c(Student_ID))
# Define colors
my_cols <- c("Red", "Blue")

#Rename labels
students_scatter_matrix <- students_scatter_matrix %>%
  rename(
    Study = Study_Hours_Per_Day,
    Extracurricular = Extracurricular_Hours_Per_Day,
    Sleep = Sleep_Hours_Per_Day,
    Social = Social_Hours_Per_Day,
    Physical_Activity = Physical_Activity_Hours_Per_Day,
    GPA = Grades
  )

# Make Stress_Level a factor
students_scatter_matrix$Gender <- as.factor(students_scatter_matrix$Gender)

# Create a color map
color_map <- setNames(
  my_cols[
    1:length(
      levels(
  students_scatter_matrix$Gender
  ))],
  levels(
    students_scatter_matrix$Gender
    )
  )

# Plot Gender as colors and without Stress_Level
plot(
  subset(
    students_scatter_matrix, 
    select = -c(Gender, Stress_Level)
    ),
  pch = ".",
  col = color_map[students_scatter_matrix$Gender],
)
```

For the second scatter plot matrix, we mapped the color to the gender of each student in the data set. Each blue point represents a blue student and each red point represents a female student. This was done to help meet CARE principles. We wanted to make sure that there was not only an even representation of male and females, but that it also wasn't skewed in any particular way that would lead to results that could be interpreted as sexist against either gender.

In these scatter plots, we noticed a noticeable possible relation between the variables with the GPA and stress. Study hours and physical activity have the strongest visible relation with grades. An increase in stress seemingly occurs with an increase of the hours spent studying, doing physical activity, being social, and physical activity, while the decrease of sleep hours also increases stress.

### Frequency table

```{r}
#| label: tbl-student_stress_summary
#| tbl-cap: "Summary Statistics on Grades by Stress Level"
#| tbl-pos: H
#| html-table-processing: none
#| lst-label: lst-table1
#| lst-cap: "Code Chunk for Making Table"
# Make summary table for Grades by Stress Level ----
student_stress_summary <- student_4 %>%
  select(Stress_Level, Grades) %>%
  group_by(Stress_Level) %>%
  summarize(
    count = n(),
    min = min(Grades),
    Q1 = quantile(Grades, 0.25),
    median = median(Grades),
    Q1 = quantile(Grades, 0.75),
    max = max(Grades),
    mad = mad(Grades),
    mean = mean(Grades),
    count = n(), 
    min = min(Grades), 
    Q1 = quantile(Grades, 0.25), 
    median = median(Grades), 
    Q3 = quantile(Grades, 0.75), 
    max = max(Grades), 
    mad = mad(Grades), 
    mean = mean(Grades), 
    sd = sd(Grades)
  )
student_stress_summary %>%
  knitr::kable()
```

From the summery table we can get a better understanding of the data we are working with. If we look at the *count* column we can see that the highest stress level among students is High, followed by Moderate, then low. It was also interesting to see how stress level impacted the various statistics in relation to a students GPA. From the table we were able to find out that there is a relation between a students stress level and GPA with higher levels of stress being related to higher GPAs. We also found it interesting how students with low stress typically had lower GPAs, signaling that caring about your grades makes you more stressed and vice versa.

### Frequency graphs

```{r}
#| label: gpa-stress_plot
#| fig-cap: "Student GPAs by stress level"
#| fig-pos: H
#| fig-height: 6
#| fig-alt: "Box and wisker plot showin student GPA by stress level"
#| lst-label: lst-gpa-stress
#| lst-cap: "Code Chunk for GPA Stress Plot"
#relevels stress level by low, moderate, high
student_4$Stress_Level <- fct_relevel(student_4$Stress_Level, "Low", "Moderate", "High")

#generates box and whisker plot
ggplot(
  student_4,
  aes(
    x = Stress_Level,
    y = Grades,
    fill = Stress_Level
  )
) +
  geom_boxplot(fill = "lightblue", color = "black") +
  labs(title = "Student GPAs by Stress level", x = "Student Stress Level", y = "Student GPAs (4.0 scale)") +
  theme_minimal()
```

The Box and Whisker plot @gpa-stress_plot allows us to confirm what we learned about the relationship between a students stress level and there GPA from our summery table. The plot visually displays the distributions for each stress level by showing the median, upper and lower quartiles, and any outlier points. From this plot we are able to able to verify that students with higher levels of stress tend to have higher GPAs, while those with lower stress levels tend to have lower GPAs. This reinforces the positive relation observed in the data.

## Main Analysis

### Hypothesis

This study examines how different aspects of students’ daily routines, specifically the amount of time dedicated to studying, sleep duration, physical activity, social interaction, and participation in extracurricular activities, are associated with both self-reported stress levels and academic performance as measured by GPA. To drive the analysis, the following detailed hypotheses are proposed:

1.  Stress Level and GPA

    -   H0: The mean GPA is equal across all stress categories (Low, Moderate, High).

    -   H1: The mean GPA differs across stress categories.

2.  Study Hours

    -   H0 (gpa): There is no linear relationship between daily study hours and GPA .

    -   H1 (gpa): Daily study hours are correlated with GPA .

    -   H0 (stress): Mean daily study hours are equal across stress categories.

    -   H1 (stress): Mean daily study hours differ across stress categories.

3.  Sleep Duration

    -   H0 (gpa): There is no linear relationship between sleep hours and GPA .

    -   H1 (gpa): Sleep hours are correlated with GPA .

    -   H0 (stress): Mean sleep hours are equal across stress categories

    -   H1 (stress): Mean sleep hours differ across stress categories.

4.  Physical Activity

    -   H0 (gpa): No correlation between physical activity hours and GPA .

    -   H1 (gpa): Physical activity hours are correlated with GPA .

    -   H0 (stress): Mean physical activity hours are equal across stress categories.

    -   H1 (stress): Mean physical activity hours differ across stress categories.

5.  Social Engagement

    -   H0 (gpa): No correlation between social hours and GPA.

    -   H1 (gpa): Social hours are correlated with GPA.

    -   H0 (stress): Mean social hours are equal across stress categories.

    -   H1 (stress): Mean social hours differ across stress categories.

6.  Extracurricular Involvement

    -   H0 (gpa): No linear association between extracurricular hours and GPA.

    -   H1 (gpa): Extracurricular hours are correlated with GPA.

    -   H0 (stress): Mean extracurricular hours are equal across stress categories.

    -   H1 (stress): Mean extracurricular hours differ across stress categories.

7.  Anxiety

    -   H0: Mean GPA is equal for students with and without anxiety.

    -   H1: Mean GPA differs between students with and without anxiety.

8.  Depression

    -   H0: Mean GPA is equal for students with and without depression.

    -   H1: Mean GPA differs between students with and without depression.

9.  Panic Attacks

    -   H0: Mean GPA is equal for students with and without panic attacks.

    -   H1: Mean GPA differs between students with and without panic attacks.

### Data analysis

In our preliminary analyses, we employed one‑way analysis of variance (ANOVA) to compare mean outcomes between categorical groups and simple linear regression to quantify relationships between continuous variables. ANOVA is appropriate when the independent variable (for example, stress level) is categorical and the outcome (such as GPA) is quantitative; regression is used when both predictor and outcome are quantitative. We set our significance threshold at p \< 0.05, meaning that any test yielding a p‑value below this cutoff leads us to reject the null hypothesis of no association or no difference. Only those relationships for which the null hypothesis is rejected will be subjected to further investigation. For categorical group comparisons, we will conduct Tukey’s HSD (honest significant difference) post‑hoc tests to identify which specific pairs of group means differ and to estimate effect sizes. For regression models, we will examine estimated coefficients, R², and residual diagnostics to assess the strength, direction, and robustness of the continuous associations. These follow‑up tests complement the initial omnibus analyses by clarifying where and how variables are related.

```{r}
df <- student_raw %>%
  rename(
    Grades = Grades,
    Stress_Level = Stress_Level,
    Study_Hours_Per_Day = Study_Hours_Per_Day,
    Sleep_Hours_Per_Day = Sleep_Hours_Per_Day,
    Physical_Activity_Hours_Per_Day = Physical_Activity_Hours_Per_Day,
    Social_Hours_Per_Day = Social_Hours_Per_Day,
    Extracurricular_Hours_Per_Day = Extracurricular_Hours_Per_Day
  ) %>%
  mutate(
    Stress_Level = factor(Stress_Level, c("Low", "Moderate", "High"))
  )

# Define models
anova_stress <- aov(Grades ~ Stress_Level, data = df)
anova_study  <- aov(Study_Hours_Per_Day ~ Stress_Level, data = df)
anova_sleep  <- aov(Sleep_Hours_Per_Day ~ Stress_Level, data = df)
anova_phys   <- aov(Physical_Activity_Hours_Per_Day ~ Stress_Level, data = df)
anova_soc    <- aov(Social_Hours_Per_Day ~ Stress_Level, data = df)
anova_extra  <- aov(Extracurricular_Hours_Per_Day ~ Stress_Level, data = df)

lm_study     <- lm(Grades ~ Study_Hours_Per_Day, data = df)
lm_sleep     <- lm(Grades ~ Sleep_Hours_Per_Day, data = df)
lm_phys      <- lm(Grades ~ Physical_Activity_Hours_Per_Day, data = df)
lm_soc       <- lm(Grades ~ Social_Hours_Per_Day, data = df)
lm_extra     <- lm(Grades ~ Extracurricular_Hours_Per_Day, data = df)

alpha <- 0.05

# Build summary table
summary_tbl <- tibble(
  Analysis = c(
    "Stress vs GPA",
    "Study Hours vs Stress",
    "Sleep Hours vs Stress",
    "Physical Activity vs Stress",
    "Social Hours vs Stress",
    "Extracurricular vs Stress",
    "Study Hours vs GPA",
    "Sleep Hours vs GPA",
    "Physical Activity vs GPA",
    "Social Hours vs GPA",
    "Extracurricular vs GPA"
  ),
  
  Types = c(
    rep("Categorical vs Quantitative", 6),
    rep("Quantitative vs Quantitative", 5)
  ),
  Test = c(
    rep("ANOVA", 6),
    rep("Linear regression", 5)
  ),
  Pvalue = c(
    broom::tidy(anova_stress)$p.value[1],
    broom::tidy(anova_study)$p.value[1],
    broom::tidy(anova_sleep)$p.value[1],
    broom::tidy(anova_phys)$p.value[1],
    broom::tidy(anova_soc)$p.value[1],
    broom::tidy(anova_extra)$p.value[1],
    broom::glance(lm_study)$p.value,
    broom::glance(lm_sleep)$p.value,
    broom::glance(lm_phys)$p.value,
    broom::glance(lm_soc)$p.value,
    broom::glance(lm_extra)$p.value
  )
) %>%
  mutate(
    H0 = if_else(Pvalue < alpha, "Reject", "Do not Reject"),
    Investigation = if_else(
      H0 == "Reject",
        if_else(grepl("ANOVA", Test),
          "Conduct Tukey HSD",
          "Examine regression coefficients"),
      "None"
    )
  )

# Output table
knitr::kable(
  summary_tbl,
  caption = "Summary of preliminary statistical tests",
  digits = 4
)
```

### Further Investigation

### Supporting research

```{r}
#| label: Cleans/wrangles supplementary dataset

#Cleans/wrangles supplementary dataset by selecting useful columns and renaiming/mutating case names and column names
mental_health_clean <- mental_health_raw %>%
  select(1, 2, 3, 4, 7, 19, 28, 39) %>%
  rename(
    major = Department,
    stress_level = Stress.Label,
    anxiety_level = Anxiety.Label,
    depression_level = Depression.Label
  ) %>%
  mutate(
    stress_level = case_when(
      stress_level == "High Perceived Stress" ~ "High",
      stress_level == "Moderate Stress" ~ "Moderate",
      stress_level == "Low Stress" ~ "Low",
      TRUE ~ stress_level
    )
  ) %>%
  mutate(
    major = case_when(
      str_detect(major, "Similar to CS") ~ "Computer Science/Engineering",
      str_detect(major, "Similar to EEE") ~ "Electrical Engineering",
      str_detect(major, "Similar to ME") ~ "Mechanical Engineering",
      str_detect(major, "Similar to CE") ~ "Civil Engineering",
      TRUE ~ major
    )
  )

```

```{r}
#| label: scholarship-stress_plot
#| fig-cap: "stress level by student scholarship status"
#| fig-pos: H
#| fig-height: 6
#| fig-alt: "Bar chart showing number of students and scholorsip status"
#| lst-label: lst-scholarship-stress
#| lst-cap: "Code Chunk for Scholarship Stress Plot"

#generates a bar chart 
ggplot(mental_health_clean, aes(x = stress_level, fill = as.factor(waiver_or_scholarship))) +
  geom_bar(position = "dodge") +
  labs(
    title = "Stress Level by Scholarship Status",
    x = "Stress Level",
    y = "Num of Students",
    fill = "Scholarship or Waiver Received"
  ) +
  theme_minimal() +
  scale_fill_manual(values = c("#1f77b4", "#ff7f0e"),
                    labels = c("No Scholarship/Waiver", "Received Scholarship/Waiver"))
```

@scholarship-stress_plot shows for all stress levels that stress levels do not have a direct relationship with weather a student has a scholarship or not. We were surprised to see that there was not as large of a positive relations as we thought. This plot leads us to believe that scholarship status/waiver status is not a primary factor in determining student stress level.

The following visualizations we will create two plots for each mental health disorder we analyse. One visualization will include the data for students enrolled in the computer science/ computer engineering major and one will not include the data. The reason for this is due to the data set we used had a majority of students enrolled as that major and generating two visualizations allows us to better analyse and comment on the data.

```{r}
student_no_CS <- mental_health_clean %>%
  filter(major != "Computer Science/Engineering")
```

```{r}
#| label: major-stress_plot
#| fig-cap: "stress level by major"
#| fig-pos: H
#| fig-height: 6
#| fig-alt: "Bar chart showing number of students and stress level per major"
#| lst-label: lst-stress
#| lst-cap: "Code Chunk for major Stress Plot"

#re levels stress levels so that they are in order
mental_health_clean$stress_level <- fct_relevel(mental_health_clean$stress_level, "Low", "Moderate", "High")

#generates  bar plot
ggplot(mental_health_clean, aes(x = major, fill = stress_level)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Stress Level Across Majors",
    x = "Major",
    y = "Number of Students"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
#| label: no-cs-stress_plot
#| fig-cap: "stress level by majors except for CS/CE"
#| fig-pos: H
#| fig-height: 6
#| fig-alt: "Bar chart showing number of students and stress level by majors except for CS/CE"
#| lst-label: lst-stress_noCS
#| lst-cap: "Code Chunk for majors except for CS/CE Stress Plot"

#re levels stress levels so that they are in order
student_no_CS$stress_level <- fct_relevel(student_no_CS$stress_level, "Low", "Moderate", "High")

#generates bar plot
ggplot(student_no_CS, aes(x = major, fill = stress_level)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Stress Level Across Majors except for CS/CE",
    x = "Major",
    y = "Number of Students"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

From @major-stress_plot and @no-cs-stress_plot we are able to learn how a students major effects there stress level. From the visualizations we are able to learn that students majoring in Civil or electrical engineering typically have higher levels of stress compared to all other majors. We are also able to see that most students perceive them selves as having moderate amounts of stress along most majors. This visualization made sense to us due to majors such as Electrical/Civil engineering are typacly seen as harder STEM major, thus causing more stress. It was interesting to see however other STEM majors such as mechanical engineering and Computer science/engineering deviate from the other engineering majors.

```{r}
#| label: major-depression_plot
#| fig-cap: "depression level by major"
#| fig-pos: H
#| fig-height: 6
#| fig-alt: "Bar chart showing number of students and depression level per major"
#| lst-label: lst-depression
#| lst-cap: "Code Chunk for major depression Plot"

#re levels depression levels so that they are in order
mental_health_clean$depression_level <- fct_relevel(mental_health_clean$depression_level, "No Depression", "Minimal Depression", "Mild Depression", "Moderate Depression", "Moderately Severe Depression", "Severe Depression")

#generates bar plot
ggplot(mental_health_clean, aes(x = major, fill = depression_level)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Depression Level Across Majors",
    x = "Major",
    y = "Number of Students"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
#| label: no-cs-depression_plot
#| fig-cap: "depression level by majors except for CS/CE"
#| fig-pos: H
#| fig-height: 6
#| fig-alt: "Bar chart showing number of students and depression level by majors except for CS/CE"
#| lst-label: lst-depression_noCS
#| lst-cap: "Code Chunk for majors except for CS/CE depression Plot"


#re levels depression levels so that they are in order
student_no_CS$depression_level <- fct_relevel(student_no_CS$depression_level, "No Depression", "Minimal Depression", "Mild Depression", "Moderate Depression", "Moderately Severe Depression", "Severe Depression")

#generates bar plot
ggplot(student_no_CS, aes(x = major, fill = depression_level)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Depression Level Across Majors except for CS/CE",
    x = "Major",
    y = "Number of students"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

From @major-depression_plot and @no-cs-depression_plot we are able to learn how a students major effects there depression level. From these visualizations we were able to find out that students studding business and entrepreneurship studies had the highest levels of depression out of all the various majors. This surprised us due to us believing that all the various mental health would all have the similar distributions among the various majors.

```{r}
#| label: major-anxiety_plot
#| fig-cap: "anxiety level by major"
#| fig-pos: H
#| fig-height: 6
#| fig-alt: "Bar chart showing number of students and anxiety level per major"
#| lst-label: lst-anxiety
#| lst-cap: "Code Chunk for major anxiety Plot"

#re levels anxiety levels so that they are in order
mental_health_clean$anxiety_level <- fct_relevel(mental_health_clean$anxiety_level, "Minimal Anxiety", "Mild Anxiety", "Moderate Anxiety", "Severe Anxiety")

#generates bar plot
ggplot(mental_health_clean, aes(x = major, fill = anxiety_level)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Anxiety Level Across Majors",
    x = "Major",
    y = "Number of Students"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
#| label: no-cs-anxiety_plot
#| fig-cap: "depression level by majors except for CS/CE"
#| fig-pos: H
#| fig-height: 6
#| fig-alt: "Bar chart showing number of students and depression level by majors except for CS/CE"
#| lst-label: lst-anxiety_noCS
#| lst-cap: "Code Chunk for majors except for CS/CE depression Plot"

#re levels anxiety levels so that they are in order
student_no_CS$anxiety_level <- fct_relevel(student_no_CS$anxiety_level, "Minimal Anxiety", "Mild Anxiety", "Moderate Anxiety", "Severe Anxiety")

#generates bar plot
ggplot(student_no_CS, aes(x = major, fill = anxiety_level)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Anxiety Level Across Majors except for CS/CE",
    x = "Major",
    y = "Number of Students"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

From @major-anxiety_plot and @no-cs-anxiety_plot we are able to learn how a students major effects there anxiety level. From this graphic we are able to see that for the majority of majors a plurality of students have severe anxiety. The two majors with the highest levels of severe anxiety were civil engineering and electrical engineering. This relation show there being a greater relation between a students stress and there anxiety compared to a students stress and depression or there anxiety and depression. Another interesting observation is that students studding Environmental and Life Sciences are the only group who has multiple levels of measured anxiety to have higher levels of moderate anxiety compared to severe anxiety. From this knowledge we potentially apply what students do for that major towards majors with higher levels of anxiety.

### Conclusion

## Data Information

### Secondary Data Set

1.  Data Tidying

2.  Data Wrangling

3.  Data Cleaning

### Fair and Care Principles

## Open Science process

## Code Appendix

## Citations

```{r}
#| label: social-GPA-residual-plot
#| fig-cap: "Social hours and GPA residuals Plot"
#| fig-pos: H
#| fig-height: 6
#| fig-alt: "Residuals plot showing the residuals vs. fitted values of each students social hours and GPA"
#| lst-label: lst-stress
#| lst-cap: "Code Chunk for residuals social hours"

#create a linear model for social hours compared to GPA
linear_model_social <- lm(
  Grades ~ Social_Hours_Per_Day, 
  data = student_4
  )
#create a residual data frame with social hours compared to GPA
residual_data_frame <- data.frame(
  Fitted = fitted(linear_model_social),
  Residuals = resid(linear_model_social)
)

# Plot residuals vs fitted values
ggplot(
  residual_data_frame, 
  aes(
    x = Fitted, 
    y = Residuals
    )
  ) +
  geom_point(
    color = "red"
    ) +
  labs(
    title = "Residual Plot for Social Hours vs Grades",
    x = "Fitted Values (Predicted GPA)",
    y = "Residuals"
  ) +
  theme_bw()
```

This residual plot shows the residual vs. fitted values(predicted GPA) of each point in the data set. This particular residual plot compares the social hours and the resulting predicted GPA. As seen in the graph, there is a plus-minus range of about 0.75 in the residuals compared to the increase in GPA, with the 0 value for the residuals being the line of best fit.

```{r}
#| label: physical-GPA-residual-plot
#| fig-cap: "Physical activity hours and GPA residuals Plot"
#| fig-pos: H
#| fig-height: 6
#| fig-alt: "Residuals plot showing the residuals vs. fitted values of each students physical activity hours and GPA"
#| lst-label: lst-stress
#| lst-cap: "Code Chunk for residuals physical activity hours"

#create a linear model for physical activity hours compared to GPA
linear_model_physical <- lm(
  Grades ~ Physical_Activity_Hours_Per_Day, 
  data = student_4
  )
#create a residual data frame for physical activity hours compared to GPA
residual_data_frame <- data.frame(
  Fitted = fitted(linear_model_physical),
  Residuals = resid(linear_model_physical)
)

# Plot residuals vs fitted values
ggplot(
  residual_data_frame, 
  aes(
    x = Fitted, 
    y = Residuals
    )
  ) +
  geom_point(
    color = "red"
    ) +
  labs(
    title = "Residual Plot for Physical Activity vs Grades",
    x = "Fitted Values (Predicted GPA)",
    y = "Residuals"
  ) +
  theme_bw()
```

This residual plot shows the residual vs. fitted values(predicted GPA) of each point in the data set. This particular residual plot compares the physical activity hours and the resulting predicted GPA. As seen in the graph, there is a plus-minus range of about 0.75 in the residuals compared to the increase in GPA, with the 0 value for the residuals being the line of best fit.

```{r}
#| label: study-GPA-residual-plot
#| fig-cap: "Study hours and GPA residuals Plot"
#| fig-pos: H
#| fig-height: 6
#| fig-alt: "Residuals plot showing the residuals vs. fitted values of each students study hours and GPA"
#| lst-label: lst-stress
#| lst-cap: "Code Chunk for residuals study hours"

#Create a linear model for study hours compared to GPA
linear_model_study <- lm(
  Grades ~ Study_Hours_Per_Day, 
  data = student_4
  )

#Create a residual data frame for study hours compared to GPA
residual_data_frame <- data.frame(
  Fitted = fitted(linear_model_study),
  Residuals = resid(linear_model_study)
)

# Plot residuals vs fitted values
ggplot(
  residual_data_frame, 
  aes(
    x = Fitted, 
    y = Residuals
    )
  ) +
  geom_point(
    color = "red"
    ) +
  labs(
    title = "Residual Plot for Study Hours vs Grades",
    x = "Fitted Values (Predicted GPA)",
    y = "Residuals"
  ) +
  theme_bw()
```

This residual plot shows the residual vs. fitted values(predicted GPA) of each point in the data set. This particular residual plot compares the study hours and the resulting predicted GPA. As seen in the graph, there is a plus-minus range of about 0.6 in the residuals compared to the increase in GPA, with the 0 value for the residuals being the line of best fit.
